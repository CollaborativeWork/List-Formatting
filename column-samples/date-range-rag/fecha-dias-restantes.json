{
  "$schema": "https://developer.microsoft.com/json-schemas/sp/column-formatting.schema.json",
  "elmType": "div",
  "style": {
    "flex-direction": "column",
    "align-items": "flex-start",
    "margin-top": "10px",
    "border": "2px solid",
    "border-color": "=if([$DueDate] <= @now, '#ff6262', if(1 - Number([$DueDate] - @now) / Number([$DueDate] - [$StartDate]) >= 0.7) && (1 - Number([$DueDate] - @now) / Number([$DueDate] - [$StartDate]) < 0.9), '#bdca73', if(1 - Number([$DueDate] - @now) / Number([$DueDate] - [$StartDate]) >= 0.9, '#ff6262', '#ffd24c'))"
  },
  "children": [
    {
      "elmType": "div",
      "style": {
        "display": "inline-flex",
        "align-items": "left",
        "font-size": "12px",
        "text-align-last": "right",
        "min-height": "inherit",
        "width": "=if([$DueDate] <= @now, '100%', if((Number([$DueDate] - @now))/86400000)>=100,'100%', (1 - Number([$DueDate] - @now) / Number([$DueDate] - [$StartDate])) * 100 + '%')"
      },
      "attributes": {
        "class": "=if([$DueDate] <= @now, 'sp-field-severity--severeWarning', if(1 - Number([$DueDate] - @now) / Number([$DueDate] - [$StartDate]) >= 0.7) && (1 - Number([$DueDate] - @now) / Number([$DueDate] - [$StartDate]) < 0.9), 'sp-field-severity--warning', if(1 - Number([$DueDate] - @now) / Number([$DueDate] - [$StartDate]) >= 0.9, 'sp-field-severity--severeWarning', 'sp-field-severity--good'))"
      }
    },
    {
      "elmType": "span",
      "txtContent": "@currentField",
      "style": {
        "position": "absolute",
        "left": "14px"
      },
      "attributes": {
        "class": "ms-fontColor-neutralSecondary"
      }
    },
    {
      "elmType": "span",
      "txtContent": "='(' + if(((Number([$DueDate] - @now))/86400000)<1 && ((Number([$DueDate] - @now))/86400000)>=0,'¡Último día!',if(((Number([$DueDate] - @now))/86400000)<2 && ((Number([$DueDate] - @now))/86400000)>=1,'quedan 2 días',if(((Number([$DueDate] - @now))/86400000)<3 && ((Number([$DueDate] - @now))/86400000)>=2,'quedan 3 días',if(((Number([$DueDate] - @now))/86400000)<4 && ((Number([$DueDate] - @now))/86400000)>=3,'quedan 4 días',if(((Number([$DueDate] - @now))/86400000)<5 && ((Number([$DueDate] - @now))/86400000)>=4,'quedan 5 días',if(((Number([$DueDate] - @now))/86400000)<6 && ((Number([$DueDate] - @now))/86400000)>=5,'quedan 6 días',if(((Number([$DueDate] - @now))/86400000)<7 && ((Number([$DueDate] - @now))/86400000)>=6,'quedan 7 días',if(((Number([$DueDate] - @now))/86400000)<8 && ((Number([$DueDate] - @now))/86400000)>=7,'quedan 8 días',if(((Number([$DueDate] - @now))/86400000)<9 && ((Number([$DueDate] - @now))/86400000)>=8,'quedan 9 días',if(((Number([$DueDate] - @now))/86400000)<10 && ((Number([$DueDate] - @now))/86400000)>=9,'quedan 10 días',if(((Number([$DueDate] - @now))/86400000)<11 && ((Number([$DueDate] - @now))/86400000)>=10,'quedan 11 días',if(((Number([$DueDate] - @now))/86400000)<12 && ((Number([$DueDate] - @now))/86400000)>=11,'quedan 12 días',if(((Number([$DueDate] - @now))/86400000)<13 && ((Number([$DueDate] - @now))/86400000)>=12,'quedan 13 días',if(((Number([$DueDate] - @now))/86400000)<14 && ((Number([$DueDate] - @now))/86400000)>=13,'quedan 14 días',if(((Number([$DueDate] - @now))/86400000)<15 && ((Number([$DueDate] - @now))/86400000)>=14,'quedan 15 días',if(((Number([$DueDate] - @now))/86400000)<16 && ((Number([$DueDate] - @now))/86400000)>=15,'quedan 16 días',if(((Number([$DueDate] - @now))/86400000)<17 && ((Number([$DueDate] - @now))/86400000)>=16,'quedan 17 días',if(((Number([$DueDate] - @now))/86400000)<18 && ((Number([$DueDate] - @now))/86400000)>=17,'quedan 18 días',if(((Number([$DueDate] - @now))/86400000)<19 && ((Number([$DueDate] - @now))/86400000)>=18,'quedan 19 días',if(((Number([$DueDate] - @now))/86400000)<20 && ((Number([$DueDate] - @now))/86400000)>=19,'quedan 20 días',if(((Number([$DueDate] - @now))/86400000)<21 && ((Number([$DueDate] - @now))/86400000)>=20,'quedan 21 días',if(((Number([$DueDate] - @now))/86400000)<22 && ((Number([$DueDate] - @now))/86400000)>=21,'quedan 22 días',if(((Number([$DueDate] - @now))/86400000)<23 && ((Number([$DueDate] - @now))/86400000)>=22,'quedan 23 días',if(((Number([$DueDate] - @now))/86400000)<24 && ((Number([$DueDate] - @now))/86400000)>=23,'quedan 24 días',if(((Number([$DueDate] - @now))/86400000)<25 && ((Number([$DueDate] - @now))/86400000)>=24,'quedan 25 días',if(((Number([$DueDate] - @now))/86400000)<26 && ((Number([$DueDate] - @now))/86400000)>=25,'quedan 26 días',if(((Number([$DueDate] - @now))/86400000)<27 && ((Number([$DueDate] - @now))/86400000)>=26,'quedan 27 días',if(((Number([$DueDate] - @now))/86400000)<28 && ((Number([$DueDate] - @now))/86400000)>=27,'quedan 28 días',if(((Number([$DueDate] - @now))/86400000)<29 && ((Number([$DueDate] - @now))/86400000)>=28,'quedan 29 días',if(((Number([$DueDate] - @now))/86400000)<30 && ((Number([$DueDate] - @now))/86400000)>=29,'quedan 30 días',if(((Number([$DueDate] - @now))/86400000)<31 && ((Number([$DueDate] - @now))/86400000)>=30,'quedan 31 días',if(((Number([$DueDate] - @now))/86400000)<32 && ((Number([$DueDate] - @now))/86400000)>=31,'quedan 32 días',if(((Number([$DueDate] - @now))/86400000)<33 && ((Number([$DueDate] - @now))/86400000)>=32,'quedan 33 días',if(((Number([$DueDate] - @now))/86400000)<34 && ((Number([$DueDate] - @now))/86400000)>=33,'quedan 34 días',if(((Number([$DueDate] - @now))/86400000)<35 && ((Number([$DueDate] - @now))/86400000)>=34,'quedan 35 días',if(((Number([$DueDate] - @now))/86400000)<36 && ((Number([$DueDate] - @now))/86400000)>=35,'quedan 36 días',if(((Number([$DueDate] - @now))/86400000)<37 && ((Number([$DueDate] - @now))/86400000)>=36,'quedan 37 días',if(((Number([$DueDate] - @now))/86400000)<38 && ((Number([$DueDate] - @now))/86400000)>=37,'quedan 38 días',if(((Number([$DueDate] - @now))/86400000)<39 && ((Number([$DueDate] - @now))/86400000)>=38,'quedan 39 días',if(((Number([$DueDate] - @now))/86400000)<40 && ((Number([$DueDate] - @now))/86400000)>=39,'quedan 40 días',if(((Number([$DueDate] - @now))/86400000)<41 && ((Number([$DueDate] - @now))/86400000)>=40,'quedan 41 días',if(((Number([$DueDate] - @now))/86400000)<42 && ((Number([$DueDate] - @now))/86400000)>=41,'quedan 42 días',if(((Number([$DueDate] - @now))/86400000)<43 && ((Number([$DueDate] - @now))/86400000)>=42,'quedan 43 días',if(((Number([$DueDate] - @now))/86400000)<44 && ((Number([$DueDate] - @now))/86400000)>=43,'quedan 44 días',if(((Number([$DueDate] - @now))/86400000)<45 && ((Number([$DueDate] - @now))/86400000)>=44,'quedan 45 días',if(((Number([$DueDate] - @now))/86400000)<46 && ((Number([$DueDate] - @now))/86400000)>=45,'quedan 46 días',if(((Number([$DueDate] - @now))/86400000)<47 && ((Number([$DueDate] - @now))/86400000)>=46,'quedan 47 días',if(((Number([$DueDate] - @now))/86400000)<48 && ((Number([$DueDate] - @now))/86400000)>=47,'quedan 48 días',if(((Number([$DueDate] - @now))/86400000)<49 && ((Number([$DueDate] - @now))/86400000)>=48,'quedan 49 días',if(((Number([$DueDate] - @now))/86400000)<50 && ((Number([$DueDate] - @now))/86400000)>=49,'quedan 50 días',if(((Number([$DueDate] - @now))/86400000)<51 && ((Number([$DueDate] - @now))/86400000)>=50,'quedan 51 días',if(((Number([$DueDate] - @now))/86400000)<52 && ((Number([$DueDate] - @now))/86400000)>=51,'quedan 52 días',if(((Number([$DueDate] - @now))/86400000)<53 && ((Number([$DueDate] - @now))/86400000)>=52,'quedan 53 días',if(((Number([$DueDate] - @now))/86400000)<54 && ((Number([$DueDate] - @now))/86400000)>=53,'quedan 54 días',if(((Number([$DueDate] - @now))/86400000)<55 && ((Number([$DueDate] - @now))/86400000)>=54,'quedan 55 días',if(((Number([$DueDate] - @now))/86400000)<56 && ((Number([$DueDate] - @now))/86400000)>=55,'quedan 56 días',if(((Number([$DueDate] - @now))/86400000)<57 && ((Number([$DueDate] - @now))/86400000)>=56,'quedan 57 días',if(((Number([$DueDate] - @now))/86400000)<58 && ((Number([$DueDate] - @now))/86400000)>=57,'quedan 58 días',if(((Number([$DueDate] - @now))/86400000)<59 && ((Number([$DueDate] - @now))/86400000)>=58,'quedan 59 días',if(((Number([$DueDate] - @now))/86400000)<60 && ((Number([$DueDate] - @now))/86400000)>=59,'quedan 60 días',if(((Number([$DueDate] - @now))/86400000)<61 && ((Number([$DueDate] - @now))/86400000)>=60,'quedan 61 días',if(((Number([$DueDate] - @now))/86400000)<62 && ((Number([$DueDate] - @now))/86400000)>=61,'quedan 62 días',if(((Number([$DueDate] - @now))/86400000)<63 && ((Number([$DueDate] - @now))/86400000)>=62,'quedan 63 días',if(((Number([$DueDate] - @now))/86400000)<64 && ((Number([$DueDate] - @now))/86400000)>=63,'quedan 64 días',if(((Number([$DueDate] - @now))/86400000)<65 && ((Number([$DueDate] - @now))/86400000)>=64,'quedan 65 días',if(((Number([$DueDate] - @now))/86400000)<66 && ((Number([$DueDate] - @now))/86400000)>=65,'quedan 66 días',if(((Number([$DueDate] - @now))/86400000)<67 && ((Number([$DueDate] - @now))/86400000)>=66,'quedan 67 días',if(((Number([$DueDate] - @now))/86400000)<68 && ((Number([$DueDate] - @now))/86400000)>=67,'quedan 68 días',if(((Number([$DueDate] - @now))/86400000)<69 && ((Number([$DueDate] - @now))/86400000)>=68,'quedan 69 días',if(((Number([$DueDate] - @now))/86400000)<70 && ((Number([$DueDate] - @now))/86400000)>=69,'quedan 70 días',if(((Number([$DueDate] - @now))/86400000)<71 && ((Number([$DueDate] - @now))/86400000)>=70,'quedan 71 días',if(((Number([$DueDate] - @now))/86400000)<72 && ((Number([$DueDate] - @now))/86400000)>=71,'quedan 72 días',if(((Number([$DueDate] - @now))/86400000)<73 && ((Number([$DueDate] - @now))/86400000)>=72,'quedan 73 días',if(((Number([$DueDate] - @now))/86400000)<74 && ((Number([$DueDate] - @now))/86400000)>=73,'quedan 74 días',if(((Number([$DueDate] - @now))/86400000)<75 && ((Number([$DueDate] - @now))/86400000)>=74,'quedan 75 días',if(((Number([$DueDate] - @now))/86400000)<76 && ((Number([$DueDate] - @now))/86400000)>=75,'quedan 76 días',if(((Number([$DueDate] - @now))/86400000)<77 && ((Number([$DueDate] - @now))/86400000)>=76,'quedan 77 días',if(((Number([$DueDate] - @now))/86400000)<78 && ((Number([$DueDate] - @now))/86400000)>=77,'quedan 78 días',if(((Number([$DueDate] - @now))/86400000)<79 && ((Number([$DueDate] - @now))/86400000)>=78,'quedan 79 días',if(((Number([$DueDate] - @now))/86400000)<80 && ((Number([$DueDate] - @now))/86400000)>=79,'quedan 80 días',if(((Number([$DueDate] - @now))/86400000)<81 && ((Number([$DueDate] - @now))/86400000)>=80,'quedan 81 días',if(((Number([$DueDate] - @now))/86400000)<82 && ((Number([$DueDate] - @now))/86400000)>=81,'quedan 82 días',if(((Number([$DueDate] - @now))/86400000)<83 && ((Number([$DueDate] - @now))/86400000)>=82,'quedan 83 días',if(((Number([$DueDate] - @now))/86400000)<84 && ((Number([$DueDate] - @now))/86400000)>=83,'quedan 84 días',if(((Number([$DueDate] - @now))/86400000)<85 && ((Number([$DueDate] - @now))/86400000)>=84,'quedan 85 días',if(((Number([$DueDate] - @now))/86400000)<86 && ((Number([$DueDate] - @now))/86400000)>=85,'quedan 86 días',if(((Number([$DueDate] - @now))/86400000)<87 && ((Number([$DueDate] - @now))/86400000)>=86,'quedan 87 días',if(((Number([$DueDate] - @now))/86400000)<88 && ((Number([$DueDate] - @now))/86400000)>=87,'quedan 88 días',if(((Number([$DueDate] - @now))/86400000)<89 && ((Number([$DueDate] - @now))/86400000)>=88,'quedan 89 días',if(((Number([$DueDate] - @now))/86400000)<90 && ((Number([$DueDate] - @now))/86400000)>=89,'quedan 90 días',if(((Number([$DueDate] - @now))/86400000)<91 && ((Number([$DueDate] - @now))/86400000)>=90,'quedan 91 días',if(((Number([$DueDate] - @now))/86400000)<92 && ((Number([$DueDate] - @now))/86400000)>=91,'quedan 92 días',if(((Number([$DueDate] - @now))/86400000)<93 && ((Number([$DueDate] - @now))/86400000)>=92,'quedan 93 días',if(((Number([$DueDate] - @now))/86400000)<94 && ((Number([$DueDate] - @now))/86400000)>=93,'quedan 94 días',if(((Number([$DueDate] - @now))/86400000)<95 && ((Number([$DueDate] - @now))/86400000)>=94,'quedan 95 días',if(((Number([$DueDate] - @now))/86400000)<96 && ((Number([$DueDate] - @now))/86400000)>=95,'quedan 96 días',if(((Number([$DueDate] - @now))/86400000)<97 && ((Number([$DueDate] - @now))/86400000)>=96,'quedan 97 días',if(((Number([$DueDate] - @now))/86400000)<98 && ((Number([$DueDate] - @now))/86400000)>=97,'quedan 98 días',if(((Number([$DueDate] - @now))/86400000)<99 && ((Number([$DueDate] - @now))/86400000)>=98,'quedan 99 días',if(((Number([$DueDate] - @now))/86400000)<100 && ((Number([$DueDate] - @now))/86400000)>=99,'quedan 100 días',if(((Number([$DueDate] - @now))/86400000)<101 && ((Number([$DueDate] - @now))/86400000)>=100,'quedan 101 días',if([$DueDate] <= @now,'¡Se acabó el tiempo! 0','100+')))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))) + ')'",
      "style": {
        "position": "absolute",
        "right": "2px",
        "top": "58px",
        "font-size": "9px",
        "color": "black"
      },
      "attributes": {
        "class": "ms-fontColor-neutralSecondary"
      }
    }
  ]
}
